/*

@mygithub: https://github.com/fredwei

@mysite: www.fredwei.com

@version v1.0.0

@License MIT

*/
!function(t,n){function i(t,n){function i(t){++o,a.push({mid:o,w:t.width,h:t.height}),o===r?n(a):e()}function e(){var n=new Image;n.src=t[o],n.complete?i(n):n.onerror=n.onload=function(){i(n)}}var o=0,r=t.length,a=[];e()}function e(){var i;n(t).on("resize",function(){clearTimeout(i),i=setTimeout(function(){l.reload()},100)})}function o(t){var n=t[0];for(var i in t)t[i]>n&&(n=t[i]);return n}function r(t){var n=t[0],i=0;for(var e in t)t[e]<n&&(n=t[e],i=e);return i}function a(t){for(var n in t)t[n]=Math.round(t[n]);return t}function c(){var t=0,n=parseFloat(u.between),i=[],e=[],c={row:0,col:0};"string"==typeof u.between&&u.between.indexOf("%")&&(n=n/100*u.boxWidth),u.betweenVal=n;var l=(u.boxWidth-u.betweenVal*(u.columns-1))/u.columns;for(t=0;t<u.columns;t++)t+1===u.columns?i.push(u.boxWidth-l):0===t?i.push(0):i.push((l+u.betweenVal)*t),e.push(0);var f,s,m=0;for(t=0;t<u.itemLen;t++)f=u.$item.eq(t),c.col=r(e),m=l*u.imgArr[t].h/u.imgArr[t].w,s=a({top:e[c.row],left:i[c.col],width:l,height:m,opacity:u.opacity}),f.css(s),e[c.row]+=m+u.betweenVal,c.row=r(e);u.$box.css("height",o(e)),"function"==typeof u.initcallback&&u.initcallback(u.$box)}var l={},u={box:".waterfall",item:".waterfall_item",itemimg:"img",columns:3,between:"1%",isResize:!0,opacity:1,lazy:!0,initcallback:function(t){}};l.imgload=function(t,e){var o=n(t),r=[],a="";o.find(u.itemimg).each(function(){a=u.lazy?n(this).attr("data-original")||n(this).attr("src"):n(this).attr("src"),r.push(a)}),i(r,e)},l.reload=function(){l.imgload(u.box,function(t){u.$box=n(u.box),u.boxWidth=u.$box.width(),u.$item=n(u.item),u.itemLen=u.$item.length,u.imgArr=t,c()})},l.set=function(t){var i=["columns","between"],e=!1;for(var o in t)n.inArray(o,i)>-1&&(e=!0,u[o]=t[o]);e&&l.reload()},l.init=function(t){u=n.extend(u,t),u.isResize&&e(),l.reload()},t.waterfall=l}(window,$);