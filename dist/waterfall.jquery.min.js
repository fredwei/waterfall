/*

@mygithub: https://github.com/fredwei

@mysite: www.fredwei.com

@version v1.0.0

@License MIT

*/
!function(e,t){function n(e,t){function n(e){++o,a.push({mid:o,w:e.width,h:e.height}),o===r?t(a):i()}function i(){var t=new Image;t.src=e[o],t.complete?n(t):t.onerror=t.onload=function(){n(t)}}var o=0,r=e.length,a=[];i()}function i(){var n;t(e).on("resize",function(){clearTimeout(n),n=setTimeout(function(){c.reload()},100)})}function o(e){var t=e[0];for(var n in e)e[n]>t&&(t=e[n]);return t}function r(e){var t=e[0],n=0;for(var i in e)e[i]<t&&(t=e[i],n=i);return n}function a(){var e=0,t=parseFloat(l.between),n=[],i=[],a={row:0,col:0};"string"==typeof l.between&&l.between.indexOf("%")&&(t=t/100*l.boxWidth),l.betweenVal=t;var c=(l.boxWidth-l.betweenVal*(l.columns-1))/l.columns;for(e=0;e<l.columns;e++)e+1===l.columns?n.push(l.boxWidth-c):0===e?n.push(0):n.push((c+l.betweenVal)*e),i.push(0);var u,f=0;for(e=0;e<l.itemLen;e++)u=l.$item.eq(e),a.col=r(i),f=c*l.imgArr[e].h/l.imgArr[e].w,u.css({top:i[a.row],left:n[a.col],width:c,height:f,opacity:l.opacity}),i[a.row]+=f+l.betweenVal,a.row=r(i);l.$box.css("height",o(i)),"function"==typeof l.initcallback&&l.initcallback(l.$box)}var c={},l={box:".waterfall",item:".waterfall_item",itemimg:"img",columns:3,between:"1%",isResize:!0,opacity:1,initcallback:function(e){}};c.imgload=function(e,i){var o=t(e),r=[];o.find(l.itemimg).each(function(){r.push(t(this).attr("src"))}),n(r,i)},c.reload=function(){c.imgload(l.box,function(e){l.$box=t(l.box),l.boxWidth=l.$box.width(),l.$item=t(l.item),l.itemLen=l.$item.length,l.imgArr=e,a()})},c.set=function(e){var n=["columns","between"],i=!1;for(var o in e)t.inArray(o,n)>-1&&(i=!0,l[o]=e[o]);i&&c.reload()},c.init=function(e){l=t.extend(l,e),l.isResize&&i(),c.reload()},e.waterfall=c}(window,$);