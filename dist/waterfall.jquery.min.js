/*

@mygithub: https://github.com/fredwei

@mysite: www.fredwei.com

@version v1.0.0

@License MIT

*/
!function(e,n){function t(e,n){function t(e){++o,a.push({mid:o,w:e.width,h:e.height}),o===r?n(a):i()}function i(){var n=new Image;n.src=e[o],n.complete?t(n):n.onerror=n.onload=function(){t(n)}}var o=0,r=e.length,a=[];i()}function i(){var t;n(e).on("resize",function(){clearTimeout(t),t=setTimeout(function(){c.reload()},100)})}function o(e){var n=e[0];for(var t in e)e[t]>n&&(n=e[t]);return n}function r(e){var n=e[0],t=0;for(var i in e)e[i]<n&&(n=e[i],t=i);return t}function a(){var e=0,n=parseFloat(l.between),t=[],i=[],a={row:0,col:0};"string"==typeof l.between&&l.between.indexOf("%")&&(n=n/100*l.boxWidth),l.betweenVal=n;var c=(l.boxWidth-l.betweenVal*(l.columns-1))/l.columns;for(e=0;e<l.columns;e++)e+1===l.columns?t.push(l.boxWidth-c):0===e?t.push(0):t.push((c+l.betweenVal)*e),i.push(0);var u,f=0;for(e=0;e<l.itemLen;e++)u=l.$item.eq(e),a.col=r(i),f=c*l.imgArr[e].h/l.imgArr[e].w,u.css({top:i[a.row],left:t[a.col],width:c,height:f,opacity:1}),i[a.row]+=f+l.betweenVal,a.row=r(i);l.$box.css("height",o(i)),"function"==typeof l.initcallback&&l.initcallback(l.$box)}var c={},l={box:".waterfall",item:".waterfall_item",itemimg:"img",columns:3,between:"1%",isResize:!0,initcallback:function(e){}};c.imgload=function(e,i){var o=n(e),r=[];o.find(l.itemimg).each(function(){r.push(n(this).attr("src"))}),t(r,i)},c.reload=function(){c.imgload(l.box,function(e){l.$box=n(l.box),l.boxWidth=l.$box.width(),l.$item=n(l.item),l.itemLen=l.$item.length,l.imgArr=e,a()})},c.set=function(e){var t=["columns","between"],i=!1;for(var o in e)n.inArray(o,t)>-1&&(i=!0,l[o]=e[o]);i&&c.reload()},c.init=function(e){l=n.extend(l,e),l.isResize&&i(),c.reload()},e.waterfall=c}(window,$);